{"ast":null,"code":"import * as signalR from '@microsoft/signalr';\nimport { HubConnectionBuilder, Subject } from '@microsoft/signalr';\nimport { apiUrl } from '../../main';\nexport class TrackInfo {\n  constructor() {\n    this.isBeat = false;\n    this.trackInfo = '';\n  }\n}\nexport class SignalrService {\n  constructor() {\n    this.$allFeed = new Subject();\n  }\n  get AllFeedObservable() {\n    return this.$allFeed;\n  }\n  startConnection() {\n    return new Promise((resolve, reject) => {\n      var conn = apiUrl + \"/hub\";\n      this.hubConnection = new HubConnectionBuilder().withUrl(conn, {\n        skipNegotiation: true,\n        transport: signalR.HttpTransportType.WebSockets\n      }).build();\n      this.hubConnection.start().then(() => {\n        console.log(\"connection established\");\n        return resolve(true);\n      }).catch(err => {\n        console.log(\"error occured \" + apiUrl + err);\n        reject(err);\n      });\n    });\n  }\n  listenToAllFeeds() {\n    this.hubConnection.on(\"TrackInfo\", data => {\n      this.$allFeed.next(data);\n    });\n  }\n}","map":{"version":3,"mappings":"AAAA,OAAO,KAAKA,OAAO,MAAM,oBAAoB;AAC7C,SAAwBC,oBAAoB,EAAEC,OAAO,QAAQ,oBAAoB;AAEjF,SAASC,MAAM,QAAQ,YAAY;AAGnC,OAAM,MAAOC,SAAS;EAAtBC;IACE,WAAM,GAAY,KAAK;IACvB,cAAS,GAAW,EAAE;EACxB;;AAEA,OAAM,MAAOC,cAAc;EAA3BD;IAGU,aAAQ,GAAuB,IAAIH,OAAO,EAAa;EAkCjE;EA/BE,IAAWK,iBAAiB;IAC1B,OAAO,IAAI,CAACC,QAAQ;EACtB;EAEOC,eAAe;IACpB,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAI;MACrC,IAAIC,IAAI,GAAGV,MAAM,GAAG,MAAM;MAC1B,IAAI,CAACW,aAAa,GAAG,IAAIb,oBAAoB,EAAE,CAC5Cc,OAAO,CAACF,IAAI,EAAE;QACbG,eAAe,EAAE,IAAI;QACrBC,SAAS,EAAEjB,OAAO,CAACkB,iBAAiB,CAACC;OACtC,CAAC,CAACC,KAAK,EAAE;MAEZ,IAAI,CAACN,aAAa,CAACO,KAAK,EAAE,CACvBC,IAAI,CAAC,MAAK;QAETC,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;QACrC,OAAOb,OAAO,CAAC,IAAI,CAAC;MACtB,CAAC,CAAC,CACDc,KAAK,CAAEC,GAAQ,IAAI;QAClBH,OAAO,CAACC,GAAG,CAAC,gBAAgB,GAAGrB,MAAM,GAAGuB,GAAG,CAAC;QAC5Cd,MAAM,CAACc,GAAG,CAAC;MACb,CAAC,CAAC;IACN,CAAC,CAAC;EACJ;EAEOC,gBAAgB;IACL,IAAI,CAACb,aAAc,CAACc,EAAE,CAAC,WAAW,EAAGC,IAAe,IAAI;MACtE,IAAI,CAACrB,QAAQ,CAACsB,IAAI,CAACD,IAAI,CAAC;IAC1B,CAAC,CAAC;EACJ","names":["signalR","HubConnectionBuilder","Subject","apiUrl","TrackInfo","constructor","SignalrService","AllFeedObservable","$allFeed","startConnection","Promise","resolve","reject","conn","hubConnection","withUrl","skipNegotiation","transport","HttpTransportType","WebSockets","build","start","then","console","log","catch","err","listenToAllFeeds","on","data","next"],"sourceRoot":"","sources":["C:\\Project\\DmxLightV2\\LightMixerAngular\\ClientApp\\src\\app\\fetch-data\\SignalrService.ts"],"sourcesContent":["import * as signalR from '@microsoft/signalr';\r\nimport { HubConnection, HubConnectionBuilder, Subject } from '@microsoft/signalr';\r\nimport { environment } from '../../environments/environment';\r\nimport { apiUrl } from '../../main';\r\n\r\n\r\nexport class TrackInfo {\r\n  isBeat: boolean = false;\r\n  trackInfo: string = '';\r\n}\r\n\r\nexport class SignalrService {\r\n\r\n  private hubConnection: any;\r\n  private $allFeed: Subject<TrackInfo> = new Subject<TrackInfo>();\r\n\r\n\r\n  public get AllFeedObservable(): Subject<TrackInfo> {\r\n    return this.$allFeed;\r\n  }\r\n\r\n  public startConnection() {\r\n    return new Promise((resolve, reject) => {\r\n      var conn = apiUrl + \"/hub\";\r\n      this.hubConnection = new HubConnectionBuilder()\r\n        .withUrl(conn, {\r\n          skipNegotiation: true,\r\n          transport: signalR.HttpTransportType.WebSockets\r\n        }).build();\r\n\r\n      this.hubConnection.start()\r\n        .then(() => {\r\n\r\n          console.log(\"connection established\");\r\n          return resolve(true);\r\n        })\r\n        .catch((err: any) => {\r\n          console.log(\"error occured \" + apiUrl + err);\r\n          reject(err);\r\n        });\r\n    });\r\n  }\r\n\r\n  public listenToAllFeeds() {\r\n    (<HubConnection>this.hubConnection).on(\"TrackInfo\", (data: TrackInfo) => {\r\n      this.$allFeed.next(data);\r\n    });\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}